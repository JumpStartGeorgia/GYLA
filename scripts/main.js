function o_delete_handler(){var a=confirm("დარწმუნებული ხართ?");if(!a){return}$(this).parent().remove()}function another_degree(){addcode='<div class="document_box group" style="border: 0 none; margin-bottom: 10px;">'+"<select name='person_education_degree[]'>"+'<option value="null" selected="selected" disabled>None</option>'+'<option value="bachelor">ბაკალავრი  (B.A.)</option>'+'<option value="llm">მაგისტრი     (LL.M.)</option>'+'<option value="phd">დოქტორი    (Ph.D.)</option>'+"</select>     "+"საიდან: "+'<input type="text" class="text_field datepicker" name="person_education_degree_from[]" style="width: 73px;" /> '+"  სადამდე: "+'<input type="text" class="text_field datepicker" name="person_education_degree_to[]" style="width: 73px !important;" />'+'<div class="o_delete_button">⨯</div>'+"</div>";$("#fromto").append(addcode);$(".o_delete_button").unbind("click",o_delete_handler).click(o_delete_handler);datepicker_init()}function get_offices(a){a=a||"";$("#officesdropdown").toggle().load(baseurl+"people/ajax_read_offices/"+a,function(){})}function submit_comment(a){if($("#comment_form_input"+a).val()=="")return false;$("#comments"+a).load(baseurl+"comment/ajax_submit_comment/"+a,{body:$("#comment_form_input"+a).val()},function(){$("#comment_form_input"+a).focus();$(".delete_comment").unbind("click").live("click",delete_comment)});return false}function get_comments(a){var b=$("#loading-post-"+a).css({"margin-top":50}).show();$("#comments"+a).css({"margin-top":50}).toggle().load(baseurl+"comment/ajax_read_comments/"+a,function(){b.toggle();$("#comment_form_input"+a).focus()})}function keydownhandler(a,b){enter_pressed=false;var c=$("#comment_form_input"+b);if(a.keyCode==13&&a.shiftKey){var d=c.height()+15;c.css("height",d)}else if(a.keyCode==13){$("#comment_form"+b).submit();a.preventDefault()}}function show_comment_form(a){var b=$("#comment_form"+a);var c=$("#comment_form_input"+a);b.toggle();c.focus();$("#comments"+a).toggle()}function datepicker_init(){$(".datepicker").datepicker({dateFormat:"yy-mm-dd",changeMonth:true,changeYear:true,yearRange:"1900:+0"});$(".datepicker_max").datepicker({dateFormat:"yy-mm-dd",changeMonth:true,changeYear:true,yearRange:"1900:+25"})}function delete_comment(){event.preventDefault();var a=$(this).attr("id"),b=a.split("_"),c=b[1],d=$(this);if(typeof c=="undefined"){return false}$.get(baseurl+"comment/ajax_delete_comment/"+c,function(a){if(a!="ok"){return false}d.parent().parent().fadeOut(function(){$(this).remove()})})}function setbaseurl(a){baseurl=a}$(function(){$("a#feedback").hover(function(){$(this).stop().animate({opacity:.65},"fast")},function(){$(this).stop().animate({opacity:1},"fast")}).fancybox({width:"65%",height:"65%",autoScale:false,titleShow:false,type:"iframe"})});var selectID=function(a){return document.getElementById(a)};$(function(){function m(a,b){if(b)$("#"+b+"_form").hide();$("#"+a+"_form").show()}var a=$("#filter_text"),b=$("#filter_photo"),c=$("#filter_video"),d=$("#filter_document"),e=$("#new_post"),f=$("#new_post_attachment"),g=$("#text_form"),h=$("#photo_form"),i=$("#video_form"),j=$("#document_form"),k="images/images/filters/",l=false;$(".delete_comment").unbind("click").live("click",delete_comment);a.click(function(){if(e.is(":visible")&&g.is(":visible")){e.slideToggle("normal")}else if(e.is(":visible")&&!g.is(":visible")){m("text",l);l="text"}else{m("text",l);e.slideToggle("normal");l="text"}});b.click(function(){if(e.is(":visible")&&h.is(":visible")){e.slideToggle("normal")}else if(e.is(":visible")&&!h.is(":visible")){m("photo",l);l="photo"}else{m("photo",l);e.slideToggle("normal");l="photo"}});c.click(function(){if(e.is(":visible")&&i.is(":visible")){e.slideToggle("normal")}else if(e.is(":visible")&&!i.is(":visible")){m("video",l);l="video"}else{m("video",l);e.slideToggle("normal");l="video"}});d.click(function(){if(e.is(":visible")&&j.is(":visible")){e.slideToggle("normal")}else if(e.is(":visible")&&!j.is(":visible")){m("document",l);l="document"}else{m("document",l);e.slideToggle("normal");l="document"}});$("#showpeopleform").click(function(){$("#people_form").slideToggle("fast")})});$(document).ready(function(){$("a.single_image").fancybox();$("a.inline").fancybox({hideOnContentClick:true});$("a.group").fancybox({speedIn:600,speedOut:200,overlayShow:false})});$(function(){datepicker_init();$("#ui-datepicker-div").css({fontSize:13})});var t;$(function(){$("#another_phone").click(function(){var a='<div class="document_box group" style="border: 0 none;">'+"<select name='person_phone_type[]'>"+"<option value='home'>სახლი</option>"+"<option value='mobile'>მობილური</option>"+"<option value='work'>სამსახური</option>"+"</select> "+'<input type="text" name="person_phone_number[]" class="text_field phonefield" />'+'<div class="o_delete_button">⨯</div>'+"</div>";$(this).parent().find(".p_values_container").append(a);$(".o_delete_button").unbind("click",o_delete_handler).click(o_delete_handler)});$("#another_affiliation").click(function(){var a='<div class="document_box group" style="border: 0 none; margin-bottom: 10px;">'+'<select name="person_affiliation_type[]">'+'<option value="staff">წევრი</option>'+'<option value="organisation">თანამშრომელი</option>'+"</select>    "+"საიდან: "+'<input type="text" name="person_affiliation_from[]" class="text_field datepicker_max" '+'style="width: 75px; margin-right: 11px;" /> '+"სადამდე: "+'<input type="text" name="person_affiliation_to[]" class="text_field datepicker_max" style="width: 75px" />'+'<div class="o_delete_button">⨯</div>'+"</div>";$(this).parent().find(".p_aff_container").append(a);$(".o_delete_button").unbind("click",o_delete_handler).click(o_delete_handler);datepicker_init()});$("#potherlanguage").change(function(){if($(this).val().length==0)$(this).removeAttr("name");else $(this).attr("name","person_languages[]")});$("#potherinterest").change(function(){if($(this).val().length==0)$(this).removeAttr("name");else $(this).attr("name","person_interested[]")})});var split=function(a){return a.split(/,\s*/)},extractLast=function(a){return split(a).pop()};$(function(){var a=$("#pref"),b={source:baseurl+"people/autocomplete/reference/"},c={source:function(a,b){$.getJSON(baseurl+"people/autocomplete/language/",{term:extractLast(a.term)},b)},search:function(){var a=extractLast(this.value);if(a.length<2){return false}},focus:function(){return false},select:function(a,b){var c=split(this.value);c.pop();c.push(b.item.value);c.push("");this.value=c.join(", ");return false}};$("#pref").autocomplete(b)});$(function(){var a={CheckBoxes:$('input[type="checkbox"][name="person_languages[]"]'),Labels:$(".personLangLabel[for]")},b={Button:$("#other-lang"),Field:$("#potherlanguage"),theLanguages:new Array},c=function(a){$.each(a,function(a,b){$(b).bind("click",function(){if(!$(this).is(":checked")){$([this,$('label[for="'+$(this).attr("id")+'"]')]).each(function(){$(this).fadeOut(function(){$(this).remove()})})}})})};if(a.CheckBoxes.length!==0)c(a.CheckBoxes);if(b.Button.length!==0)b.Button.click(function(d){d.preventDefault();b.theLanguages=b.Field.attr("value").split(",");var e=function(a){var b=new Array,c=null;for(var d in a){c=$.trim(a[d]);if(c.length!==0)b.push(c)}return b};b.theLanguages=e(b.theLanguages);a={CheckBoxes:$('input[type="checkbox"][name="person_languages[]"]'),Labels:$(".personLangLabel[for]")};var f=new Array;for(var g in a.Labels){var h=$.trim(a.Labels[g].innerHTML);if(h.length>0)f.push(h)}var i=new Array;$.each(b.theLanguages,function(a,b){if($.inArray(b,f)===-1&&$.inArray(b,i)===-1)i.push(b)});for(var g in i){var j=new Array;j.push('<input type="checkbox" name="person_languages[]" class="text_field" id="p'+i[g]+'" checked="checked" value="22">');j.push('<label class="personLangLabel" for="p'+i[g]+'">'+i[g]+"</label>");$("#show_other_languages").before(j.join(""))}b.Field.attr("value","");c($('input[type="checkbox"][name="person_languages[]"]'))})});$(function(){var a={Box:$("#search-main-box"),Toggle:$("#search-box-toggle"),Devider:$(".box-devider"),Form:{self:$("#seach-main-box form:first"),FillOut:function(a){a=$.parseJSON(a);if(typeof a.person_status_state!=="undefined"&&a.person_status_state=="on")$("#person_status_state").attr("checked","checked");if(typeof a.person_status_organization!=="undefined"&&a.person_status_organization=="on")$("#person_status_organization").attr("checked","checked");if(typeof a.person_name!=="undefined"&&a.person_name.length>0)$("#person_name").val(a.person_name);if(typeof a.person_date_start!=="undefined"&&a.person_date_start.length>0)$("#person_date_start").val(a.person_date_start);if(typeof a.person_date_end!=="undefined"&&a.person_date_end.length>0)$("#person_date_end").val(a.person_date_end);if(typeof a.person_private_number!=="undefined"&&a.person_private_number.length>0&&!isNaN(a.person_private_number))$("#person_private_number").val(a.person_private_number);if(typeof a.person_gender!=="undefined"&&a.person_gender.length>0&&isNaN(a.person_gender)&&(a.person_gender==="male"||a.person_gender==="female"))$("#person_gender_"+a.person_gender).attr("checked","checked");if(typeof a.person_tel!=="undefined"&&a.person_tel.length>0&&!isNaN(a.person_tel))$("#person_tel").val(a.person_private_number);if(typeof a.person_email!=="undefined"&&a.person_email.length>0)$("#person_email").val(a.person_email);if(typeof a.person_languages!=="undefined"&&a.person_languages.length>0)$("#person_languages").val(a.person_languages);if(typeof a.person_office!=="undefined"&&a.person_office.length>0&&!isNaN(a.person_office))$("#person_office").children('option[value="'+a.person_office+'"]:first').attr("selected","selected")},Reset:function(){$("#person_status_state").removeAttr("checked");$("#person_status_organization").removeAttr("checked");$("#person_name").val("");$("#person_date_start").val("");$("#person_date_end").val("");$("#person_private_number").val("");$("#person_gender_male").attr("checked","checked");$("#person_tel").val("");$("#person_email").val("");$("#person_languages").val("");$("#person_office").children("option:first").attr("selected","selected")},Date:[$("#person_date_start"),$("#person_date_end")],Languages:{Instance:$("#person_languages"),AutoCompleteConf:{source:function(a,b){$.getJSON(baseurl+"people/autocomplete/language/",{term:extractLast(a.term)},b)},search:function(){var a=extractLast(this.value);if(a.length<2){return false}},focus:function(){return false},select:function(a,b){var c=split(this.value);c.pop();c.push(b.item.value);c.push("");this.value=c.join(", ");return false}}},Button:{self:$("#person_search_save"),Click:function(){var b=prompt("შეიყვანე ძებნის სახელი:");if(b!==null)if(b.length>0)$.post(baseurl+"people/save_search",{name:b,data:a.Form.self.serialize()},function(b){if(b==="Saved."){a.Form.SavedSearchList.self.remove();a.Form.Button.self.after('<select id="person_saved_search"></select>');a.Form.SavedSearchList.self=$("#person_saved_search");a.Form.SavedSearchList.Fill()}else{alert(b)}});else{alert("Please enter name.");a.Form.Button.Click()}}},SavedSearchList:{self:$("#person_saved_search"),Fill:function(){$.getJSON(baseurl+"people/list_saved_search",function(b){a.Form.SavedSearchList.self.empty();var c=new Array('<option value="0">Select Search</option>');for(var d in b){c.push('<option value="'+b[d].id+'" '+(typeof theSavedSearch!=="undefined"&&b[d].id==theSavedSearch?'selected="selected"':null)+">");c.push(b[d].name);c.push("</option>")}a.Form.SavedSearchList.self.html(c.join(""))})},GetSelected:function(){var b=a.Form.SavedSearchList.self.children("option:selected:first"),c=b.attr("value");if(typeof c!=="undefined"&&!isNaN(c)&&c>0){window.location=baseurl+"people/search/?id="+c}else{a.Form.Reset()}}},Submit:$("#person_search")}};a.Devider.height(a.Devider.parent().height()-25);for(var b in a.Form.Date)a.Form.Date[b].datepicker({autoSize:true,dateFormat:"yy-mm-dd",changeMonth:true,changeYear:true});a.Form.Languages.Instance.bind("keydown",function(a){if(a.keyCode===$.ui.keyCode.TAB&&$(this).data("autocomplete").menu.active){a.preventDefault()}}).autocomplete(a.Form.Languages.AutoCompleteConf);a.Form.SavedSearchList.Fill();a.Form.Button.self.click(function(b){b.preventDefault();a.Form.Button.Click()});a.Form.SavedSearchList.self.live({change:function(){a.Form.SavedSearchList.GetSelected()}})});$(function(){function a(){var b=$(this).parent();b.find("div").show(0).click(function(){$(this).parent().remove()});clone=$(this).parent().clone();clone.html(clone.html());b.parent().append(clone);added=b.parent().find("div:last-child > input");added.change(a);added.parent().find("div").hide(0).click(function(){$(this).parent().remove()});$(this).unbind("change")}$("#change_password_button").click(function(){$(this).parent().parent().find(".hidden").show(0);$(this).parent().hide(0)});$("#cancel_change_password_button").click(function(){$(this).parent().parent().hide(0);$("#change_password_button").parent().show(0);$("#password").val("")});$(".document_delete_button").click(function(){var a=confirm("დარწმუნებული ხართ?"),b=$(this).attr("doc_id"),c=$(this);if(!a){return}$.get(baseurl+"people/delete_document_ajax/"+b,function(a){if(a){c.parent().remove()}})});$(".o_delete_button").click(o_delete_handler);$("#pdoc").change(a);$(".confirmdel").click(function(){return confirm("დარწმუნებული ხართ?")})})
