function map_styles(){var a=new OpenLayers.Style,b=[],c="proportion",d=[{from:0,to:16,color:"9183B5"},{from:16,to:33,color:"7A6DA0"},{from:33,to:50,color:"64588C"},{from:50,to:66,color:"4D4277"},{from:66,to:82,color:"372D63"},{from:82,to:100,color:"21184F"}],e=OpenLayers.Filter.Comparison.GREATER_THAN;b.push(new OpenLayers.Rule({filter:new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND,filters:[new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO,property:c,value:0})]}),symbolizer:{Polygon:{fillColor:"#beaede",strokeColor:"#fff",strokeWidth:1,fillOpacity:1}}}));for(var f in d){if(f>0)e=OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO;b.push(new OpenLayers.Rule({filter:new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND,filters:[new OpenLayers.Filter.Comparison({type:e,property:c,value:parseInt(d[f].from)}),new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO,property:c,value:parseInt(d[f].to)})]}),symbolizer:{Polygon:{fillColor:"#"+d[f].color,strokeColor:"#fff",fillOpacity:1}}}))}a.addRules(b);return new OpenLayers.StyleMap({"default":a,select:{strokeColor:"#fff",fillColor:"#9183B5",strokeWidth:0,fillOpacity:.9}})}function map_init(){map=new OpenLayers.Map("map",{controls:[],restrictedExtent:new OpenLayers.Bounds(options.boundsLeft,options.boundsBottom,options.boundsRight,options.boundsTop)});base=new OpenLayers.Layer.OSM("Georgia","http://a.tile.mapspot.ge/ndi_en/${z}/${x}/${y}.png",{numZoomLevels:19});base.setOpacity(0);layer=new OpenLayers.Layer.GML("Districts",baseurl+"events/districts",{format:OpenLayers.Format.GeoJSON,styleMap:map_styles()});var a=new OpenLayers.Control.SelectFeature(layer,{hover:true,onSelect:function(a){var b=['<b style="font-weight: bold;">'+a.attributes.name_2_geo+"</b> - "],c=a.attributes.event,d="";b+=c.length>0?"მოვლენები: "+c.length:"არ არის მოვლენები";$("#map-info").html(b).show(0)},onUnselect:function(){$("#map-info").hide(0,function(){$(this).text("")})},clickFeature:function(a){var b=a.attributes.event,c="";for(i in b){if(typeof b[i].id=="undefined"||b[i].id==null){continue}c+='<div class="switch"><a href="'+baseurl+"events/view/"+b[i].id+'">'+b[i].name+", "+" "+b[i].district_name+", "+b[i].start_at+"</a></div>"}$("#map_events").html(c)}});map.addControl(a);a.activate();map.addLayers([base,layer]);map.setCenter(new OpenLayers.LonLat(options.lon,options.lat));map.zoomTo(options.zoom)}var map,base,layer,options={boundsLeft:4260630.1231925,boundsBottom:4999230.0089212,boundsRight:5422472.9529191,boundsTop:5427277.3672416,zoom:7,lat:42.236652,lon:43.59375}
